# Inference Verification to Detect Model Weight Exfiltration.

This repo is associated with [Verifying LLM Inference to Detect Model Weight Exfiltration](https://arxiv.org/abs/2511.02620)

*The world we are hoping for:*
<img width="1289" height="464" alt="image" src="https://github.com/user-attachments/assets/8dd250aa-e3a0-40a8-8f7a-be23b75d82f9" />

*The world we want to protect against:*
<img width="1267" height="464" alt="image" src="https://github.com/user-attachments/assets/86e72421-8b6d-4b81-b923-cb0ec9852b66" />

## Abstract
As large AI models become increasingly valuable assets, the risk of model weight exfiltration from inference servers grows accordingly.
An attacker controlling an inference server may exfiltrate model weights by hiding them within ordinary model responses, a strategy known as steganography.
This work investigates how to **verify** LLM model inference to defend against such attacks and, more broadly, to detect anomalous or buggy behavior during inference.
We formalize model weight exfiltration as a security game, propose a verification framework that can provably mitigate steganographic exfiltration, and specify the trust assumptions associated with our scheme. To enable verification, we characterize valid sources of non-determinism in large language model inference and introduce two practical estimators for them.
We evaluate our detection framework on several open-weight models ranging from 3B to 30B parameters. On MOE-Qwen-30B, our detector reduces exfiltratable information to <0.5% with false-positive rate of <0.01, corresponding to a >200x slowdown for adversaries.
Overall, this work further establishes a foundation for defending against model weight exfiltration and demonstrates that strong protection can be achieved with minimal additional cost to inference providers.

*Our scheme:*
<img width="1582" height="904" alt="image" src="https://github.com/user-attachments/assets/4ce02c5f-07b6-4409-9ef8-1e80cf585504" />



## Quick Start - *I just want to verify if my tokens are honestly generated!*

**Optional pre-step: Generate tokens**
```python 
python inference_verification/generate.py --config demonstration/config_example.yaml 
```

Verify tokens

```python
python inference_verification/verify.py 
      --input generated_outputs/generated_outputs.pkl 
      --config demonstration/config_example.yaml 
```

*You can verify 18,500 tokens in 17 seconds!*
Here is how the output will look:
```
Results:
  Total tokens: 18531
  Safe tokens: 18518 (99.93%)
  Suspicious tokens: 13 (0.07%)
  Dangerous tokens: 0 (0.00%)
```

![Screenshot of verification process](assets/verify-visualization.png)


## Quick Start - *I just want to verify those plots that you made!*

```bash
./scripts/test_minimal.sh
```

This will:
1. Generate text using vLLM (100 prompts, 100 tokens each)
2. Compute GLS/CGS verification scores
3. Produce Pareto frontier plots showing FPR vs extractable information trade-offs

Results are saved to `scripts/test_run_[timestamp]/`


### Multi-Model Sweep

For production experiments across multiple models:

```bash
cd scripts
./run_GLS_all_models.sh
```


## Repo Description

This repository contains code for inference verification applied to preventing model weight exfiltration. Specifically we implement the Gumbel Likelihood Score (GLS) and Convolved Gaussian Score (CGS) methods for verifying tokens generated by large language models when running inference using the Inverse Probability Transform and Gumbel-Max Trick.

**Note on terminology:** In the paper, these methods are referred to as:
- **Inverse Probability Transform (IPT) Likelihood Score (IPT-LS)** - implemented in the codebase as **Convolved Gaussian Score (CGS)**
- **Gumbel Max Likelihood Score (GM-LS)** - implemented in the codebase as **Gumbel Likelihood Score (GLS)**

- 
## Code Contributors:
* Adam Karvonen
* Daniel Reuter
* Roy Rinberg


## Citation
```
@misc{rinberg2025verifyingllminferenceprevent,
      title={Verifying LLM Inference to Prevent Model Weight Exfiltration}, 
      author={Roy Rinberg and Adam Karvonen and Alex Hoover and Daniel Reuter and Keri Warr},
      year={2025},
      eprint={2511.02620},
      archivePrefix={arXiv},
      primaryClass={cs.CR},
      url={https://arxiv.org/abs/2511.02620}, 
}
```
