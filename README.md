# Inference Verification

## Description

This repository contains code for inference verification applied to preventing model weight exfiltration. Specifically we implement the Gumbel Likelihood Score (GLS) and Convolved Gaussian Score (CGS) methods for verifying tokens generated by large language models when running inference using the Inverse Probability Transform and Gumbel-Max Trick.

**Note on terminology:** In the paper, these methods are referred to as:
- **Inverse Probability Transform (IPT) Likelihood Score (IPT-LS)** - implemented in the codebase as **Convolved Gaussian Score (CGS)**
- **Gumbel Max Likelihood Score (GM-LS)** - implemented in the codebase as **Gumbel Likelihood Score (GLS)**


## Quick Start

Run the minimal test to verify the installation:

```bash
cd scripts
./test_minimal.sh
```

This will:
1. Generate text using vLLM (100 prompts, 100 tokens each)
2. Compute GLS/CGS verification scores
3. Produce Pareto frontier plots showing FPR vs extractable information trade-offs

Results are saved to `scripts/test_run_[timestamp]/`


### Multi-Model Sweep

For production experiments across multiple models:

```bash
cd scripts
./run_GLS_all_models.sh
```

## Code Contributors:
* Adam Karvonen
* Daniel Reuter
* Roy Rinberg


## Citation

[Add citation information here]

## License

[Add license information here]
